# Redis的过期机制

## 数据过期了就被删除了吗？
* Redis 中的数据过期后并不会立即被物理删除，而是通过以下两种主要机制逐步清理：
  - Redis有两种主要的过期删除策略：惰性删除和定期删除。
  - 惰性删除是在访问键的时候检查是否过期，如果过期了就删除。而定期删除则是每隔一段时间随机抽查一些键，删除其中过期的。这样结合起来，既不会一直占用CPU，又能及时清理过期数据。

## 惰性删除（Lazy Expiration）
* 触发时机：当客户端尝试访问一个已过期的键时，Redis 会立即检查该键是否过期。
* 行为：如果键已过期，Redis 会直接删除它，并返回 nil（表现为“不存在”）。
* 特点：过期键只有在被访问时才会被删除，未被访问的过期键可能长期驻留内存。

## 定期删除（Active Expiration）
* 触发时机：Redis 默认每隔 100ms（可配置）会随机抽取一批设置了过期时间的键进行检查。
* 行为：
  - 随机抽取一定数量的键（默认 20 个），删除其中已过期的键。
  - 如果发现过期键比例超过 25%，会继续重复此过程，直到比例低于 25% 或超时。
* 特点：通过概率性扫描，平衡内存清理与性能开销。