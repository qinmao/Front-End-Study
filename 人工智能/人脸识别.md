# 人脸识别
## 人脸识别原理
> 计算机上的视频（本质也是图片）是由数字组成的，因此通过数学计算可以图像识别
* 图像识别分类：（人脸识别是图像识别的子类）
  - 图像检测：图像里有没有人脸
  - 图像对比：检测出的人脸和预先采集的人脸的相似程度
* 人脸识别的一般步骤
  1. 图片转换为灰度
  2. 识别图像中的人脸
  3. 训练特征库，将特定的人脸标注并存入特征库
  4. 比对目标图片（视频），对目标图像出现的人脸进行判断，根据相似度做后续的处理
* 图片的组成
  > OpenCV 库可以分析图像的基本组成
  - 图像中的每个像素有三个元素组成，分别表示RGB三种颜色
  - 一张图片的宽和高由多个像素点组成

## 人脸识别常用库
* 基于特征向量方法：OpenCV
* 基于 CNN 或 HOG 方法：Tensorflow、PyTorch

## OpenCV
* 读取和保存图片
  - 读取图片： cv2.imread(图片路径和名称)
  - 显示图片：cv2.imshow()
  - 保存图片：cv2.imwrite()
* 标注图像
  > 用于调试时优化算法，一般采用矩形对图像进行标注
  - cv.rectangle(图片，坐标、color=颜色、thickness=宽度)
* 采集视频信号，并保存图片
  - 要想识别特定的人脸，需要对OpenCV的模型进行训练，训练数据一般是摄像头采集的截图，也可以是事先准备好的图片
  - 采集摄像头的数据函数：cv.VideoCapture(0),离线也可以读取MP4格式文件 cv.VideoCapture(xxx.mp4)
  
  - 从摄像头截图并保存文件函数：cv.imencode().tofile()
* 加载分类模型
  - 调用分类器: cv.CascadeClassifiler()
  - 人脸特征提取函数：face_detect.detectMultiScale(图片数组)
* OpenCV 中有几种常用的人脸检测模型
  + Haar 级联分类器 (Haar Cascade Classifier)
    - 人脸的分类器：.venv/lib/python3.12/site-packages/cv2/data/haarcascade_frontalface_default.xml
    - 这是 OpenCV 中最早引入的人脸检测方法之一，基于 Viola-Jones 算法。它使用了 Haar-like 特征和级联分类器。
    - 优点: 速度快，适用于实时应用
    - 缺点: 对光照变化和姿态变化不够鲁棒，误检率较高
  + LBP 级联分类器 (Local Binary Patterns)
    - LBP 是一种替代 Haar 特征的人脸检测方法，具有更高的准确性和速度。
    - 优点: 比 Haar 级联分类器更快，对光照变化更准确。
    - 缺点: 对复杂背景可能误检
  + DNN 模型 (Deep Neural Networks)
    - OpenCV 的 cv2.dnn 模块支持加载和使用深度学习模型进行人脸检测，通常这些模型基于 Caffe、TensorFlow 或其他深度学习框架。
    - 优点: 准确率高，对姿态和光照变更棒。
    - 缺点: 计算资源消耗大，检测速度较慢。
  + Dlib 的 HOG + SVM 和 CNN 模型
    - Dlib 提供了两种人脸检测方法：基于 HOG 和 SVM 的传统方法，以及基于 CNN 卷积神经网络。
    - 优点: HOG + SVM 度较快且对计算资源要求较低, CNN 模型准确率高,需要GPU加速
    - 缺点: CNN 模型计算资源消耗大。
  + insightface 人脸检测效果好，支持gpu和cpu 速度很快
* 调用分类器和训练模型对图片进行人脸识别
  - 读取训练模型函数：recogizer.read(训练模型)
  - 人脸识别函数：recogizer.predict()